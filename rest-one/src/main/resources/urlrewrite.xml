<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite use-context="false" decode-using="utf-8">

<!--The following is the list of headers and values expected by SockJS:

    "Access-Control-Allow-Origin" - initialized from the value of the "Origin" request header.
    "Access-Control-Allow-Credentials" - always set to true.
    "Access-Control-Request-Headers" - initialized from values from the equivalent request header.
    "Access-Control-Allow-Methods" - the HTTP methods a transport supports (see TransportType enum).
    "Access-Control-Max-Age" - set to 31536000 (1 year).-->
    
    <rule enabled="true" match-type="regex">
        <from>^(/notify/info)|(/queue/.*)$</from>
        <set type="response-header" name="Access-Control-Allow-Origin">*</set>
        <set type="response-header" name="Access-Control-Allow-Credentials">true</set>
        <set type="response-header" name="Access-Control-Allow-Headers">Access-Control-Allow-Headers,Access-Control-Allow-Origin,authorization</set>
        <!--<set type="response-header" name="Access-Control-Allow-Headers">Access-Control-Allow-Headers,Access-Control-Allow-Origin,Access-Control-Allow-Credentials,Access-Control-Allow-Methods,Access-Control-Max-Age,X-TM-UNIQUE-ID,X-CDB-CLIENT-ID,Authorization,Content-Type</set>-->
        <set type="response-header" name="Access-Control-Allow-Methods">GET,PUT,POST,DELETE,OPTIONS</set>
        <set type="response-header" name="Access-Control-Max-Age">31536000</set> <!-- 1 year -->
        <set type="response-header" name="Pragma">no-cache</set>
        <set type="response-header" name="Server">makumba</set>
    </rule>

    <rule enabled="true" match-type="regex">
        <from>^(/csrftoken)$</from>
        <condition name="origin">
            <set type="response-header" name="Access-Control-Allow-Origin">%{header:Origin}</set>
        </condition>
    </rule>

</urlrewrite>
